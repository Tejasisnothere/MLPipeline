<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Time Series Graph</title>
    <script src="https://cdn.plot.ly/plotly-2.29.1.min.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        #graph {
            width: 90%;
            height: 500px;
        }
    </style>
</head>
<body>
    <h2>Animated Time Series Graph with FastAPI + Jinja2 + Plotly</h2>
    <div id="graph"></div>

    <script>
        const data = {{ data | tojson }};
        
        const trace = {
            x: [],
            y: [],
            type: 'scatter',
            mode: 'lines+markers',
            marker: { color: 'red' }
        };

        const layout = {
            title: "Animated Time Series Plot",
            xaxis: { title: "Date", type: "date" },
            yaxis: { title: "Value" }
        };

        Plotly.newPlot('graph', [trace], layout);

        let i = 0;
        function animateGraph() {
            if (i < data.x.length) {
                Plotly.extendTraces('graph', {
                    x: [[data.x[i]]],
                    y: [[data.y[i]]]
                }, [0]);

                i++;
                setTimeout(animateGraph, 50); // controls animation speed
            }
        }

        animateGraph();
    </script>
</body>
</html>
